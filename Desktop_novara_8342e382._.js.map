{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/lazar/Desktop/novara/lib/supabase/client.ts"],"sourcesContent":["import { createBrowserClient } from \"@supabase/ssr\";\n\nexport function createClient() {\n  const url = process.env.NEXT_PUBLIC_SUPABASE_URL;\n  const anon = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n  if (!url || !anon) {\n    return null;\n  }\n  return createBrowserClient(url, anon);\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;;AAEO,SAAS;IACd,MAAM;IACN,MAAM;IACN;;IAGA,OAAO,IAAA,sNAAmB,EAAC,KAAK;AAClC","debugId":null}},
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/lazar/Desktop/novara/app/admin/%28main%29/gallery/GalleryEditor.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport { ChevronUp, ChevronDown, Pencil, Trash2, Upload } from \"lucide-react\";\n\ntype Item = {\n  id: string;\n  title: string | null;\n  caption: string | null;\n  media_type: \"image\" | \"video\";\n  media_url: string;\n  order_index: number;\n  is_published: boolean;\n};\n\nexport function GalleryEditor({ items: initial, bucket }: { items: Item[]; bucket: string }) {\n  const router = useRouter();\n  const [items, setItems] = useState(initial);\n  const [editing, setEditing] = useState<string | null>(null);\n  const [form, setForm] = useState({ title: \"\", caption: \"\" });\n  const [uploading, setUploading] = useState(false);\n\n  const supabase = createClient();\n  if (!supabase) return <p className=\"text-red-400\">Supabase not configured.</p>;\n\n  function openEdit(item: Item) {\n    setEditing(item.id);\n    setForm({ title: item.title ?? \"\", caption: item.caption ?? \"\" });\n  }\n\n  async function saveEdit() {\n    if (!editing) return;\n    await supabase.from(\"gallery_items\").update({\n      title: form.title || null,\n      caption: form.caption || null,\n    }).eq(\"id\", editing);\n    setItems((prev) => prev.map((p) => (p.id === editing ? { ...p, title: form.title, caption: form.caption } : p)));\n    setEditing(null);\n    router.refresh();\n  }\n\n  async function move(id: string, dir: number) {\n    const idx = items.findIndex((i) => i.id === id);\n    if (idx === -1 || (dir < 0 && idx === 0) || (dir > 0 && idx === items.length - 1)) return;\n    const newOrder = [...items];\n    const otherIdx = idx + dir;\n    [newOrder[idx], newOrder[otherIdx]] = [newOrder[otherIdx], newOrder[idx]];\n    for (let o = 0; o < newOrder.length; o++) {\n      await supabase.from(\"gallery_items\").update({ order_index: o }).eq(\"id\", newOrder[o].id);\n    }\n    setItems(newOrder.map((i, o) => ({ ...i, order_index: o })));\n    router.refresh();\n  }\n\n  async function remove(id: string) {\n    if (!confirm(\"Delete this item?\")) return;\n    await supabase.from(\"gallery_items\").delete().eq(\"id\", id);\n    setItems((prev) => prev.filter((i) => i.id !== id));\n    router.refresh();\n  }\n\n  async function onFileSelect(e: React.ChangeEvent<HTMLInputElement>) {\n    const file = e.target.files?.[0];\n    if (!file) return;\n    setUploading(true);\n    const ext = file.name.split(\".\").pop() ?? \"bin\";\n    const isVideo = /^(mp4|webm|mov)$/i.test(ext);\n    const path = `${Date.now()}-${file.name.replace(/\\s/g, \"-\")}`;\n    const { error: uploadErr } = await supabase.storage.from(bucket).upload(path, file, { upsert: true });\n    if (uploadErr) {\n      alert(uploadErr.message);\n      setUploading(false);\n      return;\n    }\n    const { data: urlData } = supabase.storage.from(bucket).getPublicUrl(path);\n    const maxOrder = items.length ? Math.max(...items.map((i) => i.order_index)) + 1 : 0;\n    const { data: row } = await supabase.from(\"gallery_items\").insert({\n      title: file.name,\n      caption: null,\n      media_type: isVideo ? \"video\" : \"image\",\n      media_url: urlData.publicUrl,\n      order_index: maxOrder,\n    }).select().single();\n    if (row) {\n      setItems((prev) => [...prev, row as Item]);\n      router.refresh();\n    }\n    setUploading(false);\n    e.target.value = \"\";\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <label className=\"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-accent text-white text-sm font-medium cursor-pointer\">\n        <Upload size={18} />\n        {uploading ? \"Uploadingâ€¦\" : \"Upload image or video\"}\n        <input type=\"file\" accept=\"image/*,video/*\" className=\"hidden\" onChange={onFileSelect} disabled={uploading} />\n      </label>\n      <p className=\"text-ghost/60 text-sm\">Create a bucket named &quot;site-media&quot; in Supabase Storage with public read access.</p>\n      <ul className=\"grid gap-4 sm:grid-cols-2 lg:grid-cols-3\">\n        {items.map((item) => (\n          <li key={item.id} className=\"p-3 rounded-xl bg-primary/50 border border-ghost/10\">\n            <div className=\"aspect-video rounded-lg overflow-hidden bg-graphite mb-2\">\n              {item.media_type === \"image\" ? (\n                <img src={item.media_url} alt={item.title ?? \"\"} className=\"w-full h-full object-cover\" />\n              ) : (\n                <video src={item.media_url} controls className=\"w-full h-full object-cover\" />\n              )}\n            </div>\n            {editing === item.id ? (\n              <div className=\"space-y-2\">\n                <input value={form.title} onChange={(e) => setForm((f) => ({ ...f, title: e.target.value }))} className=\"w-full px-2 py-1 rounded bg-graphite text-ghost text-sm\" placeholder=\"Title\" />\n                <input value={form.caption} onChange={(e) => setForm((f) => ({ ...f, caption: e.target.value }))} className=\"w-full px-2 py-1 rounded bg-graphite text-ghost text-sm\" placeholder=\"Caption\" />\n                <div className=\"flex gap-2\">\n                  <button type=\"button\" onClick={saveEdit} className=\"text-accent text-sm\">Save</button>\n                  <button type=\"button\" onClick={() => setEditing(null)} className=\"text-ghost/70 text-sm\">Cancel</button>\n                </div>\n              </div>\n            ) : (\n              <div className=\"flex items-center gap-2 flex-wrap\">\n                <button type=\"button\" onClick={() => move(item.id, -1)} className=\"p-1 text-ghost/70 hover:text-ghost\"><ChevronUp size={16} /></button>\n                <button type=\"button\" onClick={() => move(item.id, 1)} className=\"p-1 text-ghost/70 hover:text-ghost\"><ChevronDown size={16} /></button>\n                <span className=\"flex-1 text-ghost text-sm truncate\">{item.title ?? \"Untitled\"}</span>\n                <button type=\"button\" onClick={() => openEdit(item)} className=\"p-1 text-ghost/70 hover:text-ghost\"><Pencil size={14} /></button>\n                <button type=\"button\" onClick={() => remove(item.id)} className=\"p-1 text-red-400 hover:text-red-300\"><Trash2 size={14} /></button>\n              </div>\n            )}\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}